<div class="knowledge-bases-page">
  <!-- Page Header -->
  <rag-page-header
    [title]="'Knowledge Bases'"
    [description]="'Versioned content repositories for RAG retrieval'"
    [icon]="iconComponents.BookOpen"
    [actions]="headerActions()"
    size="lg">
  </rag-page-header>

  <div class="page-header">

    <!-- Search and Filters -->
    @if (!isEmpty()) {
      <div class="filters-section">
        <div class="search-filter">
          <rag-search-input
            placeholder="Search knowledge bases..."
            (search)="onSearchChange($event)"
            class="kb-search">
          </rag-search-input>
        </div>

        <div class="status-filter">
          <rag-select (change)="onFilterChange($event)">
            @for (option of filterOptions(); track option.value) {
              <option [value]="option.value">{{ option.label }}</option>
            }
          </rag-select>
        </div>
      </div>

      <div class="results-summary">
        @if (filteredCount() !== totalCount()) {
          <span>Showing {{ filteredCount() }} of {{ totalCount() }} knowledge bases</span>
        } @else {
          <span>{{ totalCount() }} knowledge bases</span>
        }
      </div>
    }
  </div>

  <!-- Content -->
  <div class="page-content">
    @if (isEmpty()) {
      <!-- Empty State -->
      <app-empty-state-panel
        [icon]="iconComponents.BookOpen"
        title="No knowledge bases yet"
        description="Knowledge bases store and index your content for RAG retrieval. Create your first one to get started."
        actionLabel="Create Knowledge Base"
        (action)="openCreateWizard()">
      </app-empty-state-panel>
    } @else if (hasResults()) {
      <!-- Knowledge Base Grid -->
      <div class="kb-grid">
        @for (kb of knowledgeBases$(); track kb.id) {
          <app-knowledge-base-card
            [knowledgeBase]="kb"
            [class]="kb.status"
            (reindex)="onReindexKB($event)"
            (export)="onExportKB($event)"
            (delete)="onDeleteKB($event)"
            (pause)="onPauseKB($event)"
            (cancel)="onCancelKB($event)">
          </app-knowledge-base-card>
        }
      </div>
    } @else {
      <!-- No Results State -->
      <app-empty-state-panel
        [icon]="iconComponents.BookOpen"
        title="No matching knowledge bases"
        description="Try adjusting your search or filter criteria."
        [showAction]="false">
      </app-empty-state-panel>
    }
  </div>

</div>

<!-- Model Selector Component -->
<div class="rag-model-selector" [class]="'rag-model-selector--' + variant()">

  <!-- Dropdown Variant -->
  @if (variant() === 'dropdown') {
    <div class="selector-dropdown">
      <!-- Search Input (if enabled) -->
      @if (showSearch() && modelOptions().length > 5) {
        <div class="search-wrapper">
          <rag-input
            [placeholder]="searchPlaceholder()"
            [value]="searchQuery()"
            [leftIcon]="SearchIcon"
            size="sm"
            (valueChange)="onSearchChange($event)"
            (onClear)="onSearchClear()">
          </rag-input>
        </div>
      }

      <!-- Model Select -->
      <rag-select
        [options]="modelOptions()"
        [placeholder]="placeholder()"
        [disabled]="disabled() || loading()"
        [searchable]="false"
        [clearable]="allowEmpty()"
        size="md"
        [value]="selectedModelId()"
        (valueChange)="onModelSelect($event)">
      </rag-select>

      <!-- Loading State -->
      @if (loading()) {
        <div class="loading-overlay">
          <span>Loading models...</span>
        </div>
      }

      <!-- No Models State -->
      @if (!loading() && modelOptions().length === 0) {
        <div class="empty-state">
          <rag-icon [img]="CpuIcon" size="md"></rag-icon>
          <span>No models available</span>
          <small>Import models to get started</small>
        </div>
      }
    </div>
  }

  <!-- Card Grid Variant -->
  @if (variant() === 'card-grid') {
    <div class="selector-grid">
      <!-- Search Input -->
      @if (showSearch()) {
        <div class="search-wrapper">
          <rag-input
            [placeholder]="searchPlaceholder()"
            [value]="searchQuery()"
            [leftIcon]="SearchIcon"
            size="sm"
            (valueChange)="onSearchChange($event)"
            (onClear)="onSearchClear()">
          </rag-input>
        </div>
      }

      <!-- Model Cards -->
      <div class="model-cards">
        @for (option of modelOptions(); track option.value) {
          <div
            class="model-card"
            [class.selected]="isSelected(option.value)"
            [class.disabled]="option.disabled || disabled()"
            (click)="!option.disabled && !disabled() ? onModelSelect(option.value) : null">

            <!-- Selection Indicator -->
            @if (isSelected(option.value)) {
              <div class="selection-indicator">
                <rag-icon [img]="CheckIcon" size="xs"></rag-icon>
              </div>
            }

            <!-- Model Icon -->
            <div class="model-card__icon">
              <rag-icon [img]="CpuIcon" size="md"></rag-icon>
            </div>

            <!-- Model Info -->
            <div class="model-card__info">
              <h4>{{ option.label }}</h4>
              <p>{{ option.model.description }}</p>

              <!-- Model Metadata -->
              <div class="model-card__metadata">
                <span class="metadata-item">{{ option.model.model_type }}</span>
                <span class="metadata-item">{{ option.model.size_mb }} MB</span>
                <span class="metadata-item">{{ option.model.dimensions }}D</span>
              </div>
            </div>

            <!-- Status -->
            @if (showStatus() && option.model) {
              <div class="model-card__status">
                <rag-chip
                  variant="soft"
                  [color]="getStatusColor(option.model.status)"
                  size="xs">
                  {{ option.model.status }}
                </rag-chip>
              </div>
            }
          </div>
        } @empty {
          <div class="empty-grid">
            <rag-icon [img]="CpuIcon" size="lg"></rag-icon>
            <h3>No models found</h3>
            <p>Try adjusting your search or filter criteria</p>
          </div>
        }
      </div>
    </div>
  }

  <!-- Compact Variant -->
  @if (variant() === 'compact') {
    <div class="selector-compact">
      <rag-select
        [options]="modelOptions()"
        [placeholder]="placeholder()"
        [disabled]="disabled() || loading()"
        [searchable]="showSearch()"
        [clearable]="allowEmpty()"
        size="sm"
        [value]="selectedModelId()"
        (valueChange)="onModelSelect($event)">
      </rag-select>
    </div>
  }

  <!-- Selected Models Summary (for multiple selection) -->
  @if (multiple() && selectedModels().length > 0) {
    <div class="selected-summary">
      <span class="summary-label">Selected models ({{ selectedModels().length }}):</span>
      <div class="selected-chips">
        @for (model of selectedModels(); track model.id) {
          <rag-chip
            variant="soft"
            color="blue"
            size="sm"
            [removable]="!disabled()"
            (onRemove)="onModelSelect(model.id)">
            {{ model.name }}
          </rag-chip>
        }
      </div>
    </div>
  }
</div>